<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Button State Example</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel"> 

    const loadingStyles = {
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        height: '100vh'
    };

    const loadingTextStyles = {
        fontSize: '24px',
        fontWeight: 'bold'
    };

    const emptyStateStyles = {
        textAlign: 'center',
        marginTop: '20px'
    };

    const Loading = () => (
        <div style={loadingStyles}>
            <p style={loadingTextStyles}>Loading...</p>
        </div>
    );

    const EmptyState = () => (
        <p style={emptyStateStyles}>No posts available.</p>
    );

    const App = () => {
        const [posts, setPosts] = React.useState([]);
        const [loading, setLoading] = React.useState(true);

        const fetchData = async () => {
            try {
                console.log("Fetching data...");
                const response = await fetch("https://api.tiburoncin.lat/22801/posts");
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                const data = await response.json();
                console.log("Data received:", data);
                const postsWithImages = data.map(post => ({
                    ...post,
                    Imagen: `data:image/png;base64,${post.Imagen}`,
                    Fecha: new Date(post.Fecha).toISOString().split('T')[0]
                }));
                setPosts(postsWithImages);
                setLoading(false); // Marcar carga completa
            } catch (error) {
                console.error('Error fetching data:', error);
                setLoading(false); // Marcar carga completa incluso en caso de error
            }
        };

        React.useEffect(() => {
            fetchData();
        }, []);

        return (
            <div>
                <h1>All Posts</h1>
                {loading ? (
                    <Loading />
                ) : posts.length === 0 ? (
                    <EmptyState />
                ) : (
                    <div>
                        {posts.map(post => (
                            <div key={post.Id_post}>
                                <h2>{post.Titulo}</h2>
                                <p>{post.Contenido}</p>
                                <p>User ID: {post.Id_usuario}</p>
                                <p>Date: {post.Fecha}</p>
                                <img src={post.Imagen} alt="Post Image" />
                            </div>
                        ))}
                    </div>
                )}
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'))
    root.render(<App />)
    </script>
</body>
</html>
